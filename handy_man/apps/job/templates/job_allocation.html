{% extends "base_job.html" %}
{% block controlled_table %}
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Job Allocation</title>
   
    <!-- <link rel="stylesheet" type="text/css" href="/static/admin/css/base.css">  -->
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.11/css/jquery.dataTables.min.css">
    <!-- <link rel="stylesheet" href="{{ STATIC_URL }}css/bootstrap.min.css" type="text/css" media="screen" /> -->
    
    <link rel="stylesheet" href="{{ STATIC_URL }}css/jquery.dataTables.min.css" type="text/css" media="screen" />
    
    <!-- datatable javascript 
	<script src="{{ STATIC_URL }}js/jquery-1.12.0.min.js"></script>
	<script src="{{ STATIC_URL }}js/jquery.dataTables.min.js"></script>-->
	
	<script type="text/javascript" language="javascript" src="//code.jquery.com/jquery-1.12.0.min.js">
	</script>

	<script type="text/javascript" language="javascript" src="https://cdn.datatables.net/1.10.11/js/jquery.dataTables.min.js">
	</script>
	<script>
		$(document).ready(function() {
			var job_artisans = [];
			function addJob(job_identifier, artisan_icon, artisan_username, artisan_fullname){
				
				var job_artisan = {
						identifier : job_identifier,
					    icon  : artisan_icon,
					    username : artisan_username,
					    fullname : artisan_fullname
					};
				job_artisans.push(job_artisan);
			};

		    $('#job_allocate_tb').DataTable({
		    	select: true
		    });
		    //$("input[type='radio']:checked").css("background","red");
		    
		    $('#job_allocate_tb').find('button').attr('disabled','disabled');
		    //$('#job_allocate_tb').find('button').removeAttr( "disabled");
		    $('#job_allocate_tb tbody').on( 'dblclick', 'tr', function () {
		    	$(this).closest("tr").siblings().removeClass("selected");
		        $(this).toggleClass('selected');
		
		        $('button[type="submit"]').attr('disabled','disabled');
		        $(this).find('button').removeAttr( "disabled");
		        $(this).find('button').click(function() {
			        var $job_item = $(this).closest("tr").find('input[name="job_id"]');
			        var $checked_radio_val = $("input[type='radio']:checked").val();
			        $job_item.val($checked_radio_val);
		        });
		    } );
		    $("input[type='radio']").on( 'checked', function () {
		    	$('div[class="side_nav"]').css( "background-color", "yellow" );
		    });s 
		} );
		
		
	</script>
	<style type="text/css">
		label[name='side_nav']:hover, label[name='side_nav']:active, input:hover+label[name='side_nav'], input[type='radio']:active+label[name='side_nav']{
			background:#6495ED;
			color: #F2F3F7;
		}
	</style>
</head>
<div class="row">
<div class="col-lg-9">
    <!-- /.panel -->
    
{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}

    <div class="panel panel-default">
        <div class="panel-heading">
            <i class="fa fa-bar-chart-o fa-fw"></i> Jobs
        </div>
        <!-- /.panel-heading -->
        <div class="panel-body">
<!-- <div class="container"> -->  
   
<table class="table" style=" width:100%;" id="job_allocate_tb" >
			    <thead>
			      <tr>
			        <th></th>
			        <th>Description</th>
			        <th></th>
			        <th>Action</th>
			        <th>Quote</th>
			      </tr>
			    </thead>
			    <tbody>
			    {% for job in job_interests %}
				    <tr>
				    <script>
				    	{% for artisan in job.fake_artisans_interested %}
				    		addJob('{{job.identifier}}', {{artisan.avatar_image}}, {{artisan.user.username}}, {{artisan.user.first_name}}+' '+{{artisan.user.last_name}}+' '+{{artisan.profession}});
				    	{% endfor %}
				    </script>
				        <td><img src="{{ STATIC_URL }}img/job.png" class="img-rounded" alt="Cinque Terre" width="40px" height="40px"></td>
				        <td>{{job.description}}</td>
				        <td>{{job.street}}</td>
						<td><form action="{% url 'jobs_url' %}" method="post">
               					{% csrf_token %}
		               		    <input name="artisan" id="artisan" type="hidden" value="tshepiso">
		               	 		<input name="job_identifier" type="hidden" value="{{job.identifier}}">
		               	 		<button type="submit" class="btn btn-primary">Assign</button>
		        			</form>
		        		</td>
		        		<td>
		        			<form action="{% url 'quote_url' job.pk %}" method="get">
		        				{% csrf_token %}
		        				{% if job.has_quote %}
		        					<button type="submit" class="btn btn-primary">View Quote</button>
		        				{% else %}
		        					<button type="submit" class="btn btn-primary">Generate Quote</button>
		        				{% endif %}
		        			</form>
		        		</td>
					</tr>
				{% endfor %}
			    </tbody>
			  </table>
		<!-- </div> -->                  
        </div>
        <!-- /.panel-body -->
        <div class="panel-heading">
            <i class="fa fa-bar-chart-o fa-fw"></i> Geo Location
        </div>
        <!-- /.panel-heading -->
                <div class="panel-body">
                    	<table>
                    	<tr><td>
                <div id="mapCanvas" style="width:680px;height:380px;"></div>
            	</td></tr>
            	</table>                            
        </div>
        <!-- /.panel-body -->
    </div>
    <!-- /.panel -->
</div>
<!-- /.col-lg-8 -->
<div class="col-lg-3">
    <div class="panel panel-default">
        <div class="panel-heading">
            <i class="fa fa-bell fa-fw"></i> Best Artisan
        </div>
        <!-- /.panel-heading -->
        <div class="panel-body">
            <!-- /.list-group -->
            <!--  <a href="#" class="btn btn-default btn-block">V</a> -->
        </div>
        <!-- /.panel-body -->
    </div>
    
 <div class="panel panel-default" style="width:100%"">
        <div class="panel-heading">
            <i class="fa fa-bell fa-fw"></i> Artisans
        </div>
        <!-- /.panel-heading -->
        <div class="panel-body">
			    <div style="background:#eee;" class="row" name='side_nav'>
			    	<div class="radio" style="display:inline;" class="container">
  						<label name="side_nav" style="width:100%">
  						<img src="{{ STATIC_URL }}img/user1.png" class="img-circle" alt="Cinque Terre" width="50" height="50">
  						<input type="radio" name="optradio" value="tshepiso"><a title="Kagiso Thebe">kthebe</a></label>
  						<!-- <img style="margin-right:0px" src="{{ STATIC_URL }}img/five.png" class="img-rounded" alt="Cinque Terre" width="40px" height="40px">-->
					</div>
				</div>
				<hr>
			    <div style="background:#eee;" class="row">
			    	<div class="radio" style="display:inline;" class="containers">
			    		<label name="side_nav" style="width:100%">
			    		<img src="{{ STATIC_URL }}img/team.jpg" class="img-circle" alt="Cinque Terre" width="50" height="50">
  						<input type="radio" name="optradio" value="setsiba"><a> bravo</a>
  						<!-- <img style="margin-right:0" src="{{ STATIC_URL }}img/five.png" class="img-rounded" alt="Cinque Terre" width="40px" height="40px">-->
  						</label>
					</div>
				</div>
				
				<hr>
			    <div style="background:#eee;" class="row side_nav">
			    	<div class="radio" style="display:inline;" class="containers">
			    		<label name="side_nav" style="width:100%">
			    		<img src="{{ STATIC_URL }}img/juju.jpeg" class="img-circle" alt="Cinque Terre" width="50" height="50">
  						<input type="radio" name="optradio" value="setsiba"><a> juju</a>
  						<!-- <img style="margin-right:0" src="{{ STATIC_URL }}img/five.png" class="img-rounded" alt="Cinque Terre" width="40px" height="40px">-->
  						</label>
					</div>
				</div>
				<hr>
			    <div style="background:#eee;" class="row side_nav">
			    	<div class="radio" style="display:inline;" class="containers side_nav">
			    		<label name="side_nav" style="width:100%">
			    		<img src="{{ STATIC_URL }}img/user1.png" class="img-circle" alt="Cinque Terre" width="50" height="50">
  						<input type="radio" name="optradio" value="setsiba"><a> ttiroyamodimo</a>
  						<!-- <img style="margin-right:0" src="{{ STATIC_URL }}img/five.png" class="img-rounded" alt="Cinque Terre" width="40px" height="40px">-->
  						</label>
					</div>
				</div>
				<hr>
            <!--  <a href="#" class="btn btn-default btn-block">View All Requests</a>-->
        </div>
        <!-- /.panel-body -->
    </div>
    <!-- /.panel -->
</div>
<!-- /.col-lg-4 -->
</div>
<hr>
<div class="row">
<div>

</div>
</div>
<script type="text/javascript" charset="utf8" src="{{ STATIC_URL }}js/datatableview.js"></script>
<!-- /.row -->
{% endblock %}